<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Enhanced Security Headers -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' 'sha256-xyz123' https://pagead2.googlesyndication.com https://script.google.com https://cdnjs.cloudflare.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: https: blob:; connect-src 'self' https://script.google.com https://pagead2.googlesyndication.com; object-src 'none'; base-uri 'self'; form-action 'self' https://script.google.com; upgrade-insecure-requests; block-all-mixed-content;">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
    <meta http-equiv="Permissions-Policy" content="camera=(), microphone=(), geolocation=(), payment=(), usb=(), bluetooth=()">
    <meta http-equiv="Strict-Transport-Security" content="max-age=31536000; includeSubDomains; preload">
    
    <!-- Performance Optimizations -->
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://pagead2.googlesyndication.com" crossorigin>
    <link rel="dns-prefetch" href="//script.google.com">
    <link rel="dns-prefetch" href="//instagram.com">
    <link rel="dns-prefetch" href="//tiktok.com">
    <link rel="dns-prefetch" href="//wa.me">
    <link rel="preload" href="images/logo-role.png" as="image" type="image/png">
    
    <!-- Enhanced SEO Meta Tags -->
    <meta name="keywords" content="revista, editorial, cultura, m√∫sica, arte, entretenimento, rol√™, posf√°cio, dicas, fala rol√™, bpm">
    <meta name="description" content="Revista ROL√ä: Editorial, cr√≠ticas, poesia e provoca√ß√µes da cena cultural brasileira. Descubra textos que refletem a vida noturna.">
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
    <meta name="author" content="ROL√ä Entretenimento">
    <meta name="theme-color" content="#8B5CF6">
    <link rel="canonical" href="https://roleentretenimento.com/revista.html">
    
    <!-- Enhanced Open Graph -->
    <meta property="og:title" content="Revista ROL√ä - Editorial e Cultura Independente">
    <meta property="og:description" content="Textos que refletem a cena noturna, com cr√≠ticas, poesia e provoca√ß√µes do ROL√ä">
    <meta property="og:image" content="https://roleentretenimento.com/images/editorial-madrugada.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://roleentretenimento.com/revista.html">
    <meta property="og:site_name" content="ROL√ä Entretenimento">
    <meta property="og:locale" content="pt_BR">
    
    <!-- Enhanced Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Revista ROL√ä - Editorial e Cultura Independente">
    <meta name="twitter:description" content="Textos que refletem a cena noturna, com cr√≠ticas, poesia e provoca√ß√µes do ROL√ä">
    <meta name="twitter:image" content="https://roleentretenimento.com/images/editorial-madrugada.png">
    <meta name="twitter:site" content="@role.ent">
    
    <!-- Enhanced Cache Control -->
    <meta http-equiv="Cache-Control" content="public, max-age=3600, stale-while-revalidate=86400, must-revalidate">
    <meta http-equiv="Pragma" content="cache">
    
    <!-- Critical Theme Script with enhanced security -->
    <script nonce="theme-init-2024">
        (function() {
            'use strict';
            try {
                const theme = localStorage.getItem('theme');
                if (theme === 'light') {
                    document.documentElement.setAttribute('data-theme', 'light');
                }
            } catch (e) {
                console.warn('Theme initialization error:', e);
            }
        })();
    </script>
    
    <!-- Optimized Google Ads with integrity check -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2898945215492580" crossorigin="anonymous" integrity="sha384-example" onerror="console.warn('AdSense failed to load')"></script>
    
    <title>Revista ROL√ä | Editorial e Cultura Independente</title>
    <link rel="icon" href="images/favicon.png" type="image/png" sizes="32x32">
    <link rel="apple-touch-icon" href="images/favicon.png" sizes="180x180">
    <link rel="manifest" href="manifest.json">
    
    <!-- Optimized Critical CSS with better compression -->
    <style>
        :root {
            --bg-primary: #0D0D0D;
            --bg-secondary: #1A1A1A;
            --bg-card: #1F1F1F;
            --text-primary: #FFFFFF;
            --text-secondary: #A0A0A0;
            --text-muted: #6B7280;
            --accent-purple: #8B5CF6;
            --accent-pink: #EC4899;
            --border-color: #2A2A2A;
            --gradient-primary: linear-gradient(135deg, #8B5CF6 0%, #EC4899 100%);
            --transition-fast: 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-normal: 0.3s ease;
            --font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }
        
        :root[data-theme="light"] {
            --bg-primary: #FFFFFF;
            --bg-secondary: #F8F9FA;
            --bg-card: #FFFFFF;
            --text-primary: #1F2937;
            --text-secondary: #6B7280;
            --border-color: #E5E7EB;
        }
        
        *,*::before,*::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            scroll-behavior: smooth;
            line-height: 1.15;
            -webkit-text-size-adjust: 100%;
        }
        
        body {
            font-family: var(--font-family);
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            font-size: 16px;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            transition: background-color var(--transition-normal), color var(--transition-normal);
        }
        
        .app-container {
            width: 100%;
            background: var(--bg-primary);
            min-height: 100vh;
            position: relative;
        }
        
        .app-header {
            position: sticky;
            top: 0;
            z-index: 1000;
            background: rgba(13, 13, 13, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border-color);
            will-change: transform;
        }
        
        :root[data-theme="light"] .app-header {
            background: rgba(255, 255, 255, 0.95);
        }
        
        .app-hero-section {
            text-align: center;
            padding: 24px 20px;
            margin-bottom: 16px;
        }
        
        .app-hero-title {
            font-weight: 700;
            margin-bottom: 16px;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1.2;
            font-size: clamp(1.75rem, 5vw, 2.25rem);
        }
        
        img {
            loading: lazy;
            decoding: async;
            width: auto;
            height: auto;
        }
        
        .app-logo-img {
            loading: eager;
        }
        
        @media (max-width: 768px) {
            .app-container {
                max-width: 430px;
                margin: 0 auto;
                box-shadow: 0 0 50px rgba(0, 0, 0, 0.5);
            }
        }
    </style>
    
    <!-- Enhanced async CSS loading with fallback -->
    <link rel="preload" href="estilo.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="estilo.css"></noscript>
    
    <!-- Enhanced Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "name": "Revista ROL√ä",
        "alternateName": "ROL√ä Entretenimento",
        "url": "https://roleentretenimento.com/revista.html",
        "description": "Editorial, cr√≠ticas, poesia e provoca√ß√µes da cena cultural brasileira",
        "publisher": {
            "@type": "Organization",
            "name": "ROL√ä Entretenimento",
            "logo": {
                "@type": "ImageObject",
                "url": "https://roleentretenimento.com/images/logo-role.png",
                "width": 120,
                "height": 40
            },
            "sameAs": [
                "https://instagram.com/role.ent",
                "https://tiktok.com/@role.ent"
            ]
        },
        "mainEntity": {
            "@type": "Magazine",
            "name": "Revista ROL√ä",
            "genre": ["Cultura", "Arte", "M√∫sica", "Entretenimento"],
            "audience": {
                "@type": "Audience",
                "audienceType": "Jovens interessados em cultura e entretenimento"
            }
        },
        "potentialAction": {
            "@type": "SearchAction",
            "target": "https://roleentretenimento.com/vitrine-cultural.html?q={search_term_string}",
            "query-input": "required name=search_term_string"
        }
    }
    </script>
    
    <!-- Service Worker Registration for caching -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(reg => console.log('SW registered'))
                    .catch(err => console.log('SW registration failed'));
            });
        }
    </script>
    
    <noscript>
        <style>
            .no-js-message {
                background: #EF4444;
                color: white;
                padding: 16px;
                text-align: center;
                font-weight: 600;
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                z-index: 10000;
            }
        </style>
        <div class="no-js-message">
            Para uma melhor experi√™ncia, ative o JavaScript no seu navegador.
        </div>
    </noscript>
</head>

<body>
    <div class="app-container">
        <!-- Header with enhanced accessibility -->
        <header class="app-header" role="banner">
            <div class="app-header-content">
                <a href="index.html" class="app-logo-container" rel="home" aria-label="Ir para p√°gina inicial do ROL√ä Entretenimento">
                    <img src="images/logo-role.png" alt="ROL√ä Entretenimento" class="app-logo-img" width="120" height="40" loading="eager" />
                </a>
                <div class="app-header-actions">
                    <!-- Enhanced Desktop Menu -->
                    <nav class="desktop-menu" role="navigation" aria-label="Menu principal de navega√ß√£o">
                        <a href="index.html" rel="home">Home</a>
                        <a href="revista.html" class="active" aria-current="page">Revista</a>
                        <a href="vitrine-cultural.html">Vitrine Cultural</a>
                        <a href="descontos.html">Descontos</a>
                        <a href="contato.html">Contato</a>
                        <a href="quem-somos.html">Quem Somos</a>
                    </nav>

                    <!-- Enhanced Mobile Menu Button -->
                    <button class="menu-toggle" aria-label="Abrir menu de navega√ß√£o" aria-expanded="false" aria-controls="mobileMenuOverlay" type="button">
                        <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                    </button>
                    
                    <!-- Enhanced Theme Toggle -->
                    <button class="theme-toggle-app" aria-label="Alternar entre tema claro e escuro" type="button">
                        <img src="images/theme-toggle.gif" alt="" width="24" height="24" loading="lazy" />
                    </button>
                </div>
            </div>
        </header>

        <!-- Enhanced Mobile Menu Overlay -->
        <div class="mobile-menu-overlay" id="mobileMenuOverlay" role="dialog" aria-modal="true" aria-labelledby="mobile-menu-title" aria-hidden="true">
            <nav class="mobile-menu" role="navigation">
                <div class="mobile-menu-header">
                    <img src="images/logo-role.png" alt="ROL√ä" class="mobile-menu-logo" width="100" height="32" loading="lazy" />
                    <button class="menu-close" aria-label="Fechar menu de navega√ß√£o" type="button">
                        <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>
                <ul class="mobile-menu-list" id="mobile-menu-title">
                    <li><a href="index.html" class="mobile-menu-link" rel="home">üè† P√°gina Inicial</a></li>
                    <li><a href="revista.html" class="mobile-menu-link active" aria-current="page">üì∞ Revista ROL√ä</a></li>
                    <li><a href="vitrine-cultural.html" class="mobile-menu-link">üé® Vitrine Cultural</a></li>
                    <li><a href="descontos.html" class="mobile-menu-link">üí∞ Descontos</a></li>
                    <li><a href="contato.html" class="mobile-menu-link">üìû Contato</a></li>
                    <li><a href="quem-somos.html" class="mobile-menu-link">‚ÑπÔ∏è Quem Somos</a></li>
                </ul>
                <div class="mobile-menu-footer">
                    <div class="mobile-menu-social">
                        <a href="https://instagram.com/role.ent" target="_blank" rel="noopener noreferrer" aria-label="Seguir ROL√ä no Instagram">
                            <img src="images/instagram.svg" alt="Instagram" width="20" height="20" loading="lazy" />
                        </a>
                        <a href="https://tiktok.com/@role.ent" target="_blank" rel="noopener noreferrer" aria-label="Seguir ROL√ä no TikTok">
                            <img src="images/tiktok.svg" alt="TikTok" width="20" height="20" loading="lazy" />
                        </a>
                        <a href="https://wa.me/5551980704353" target="_blank" rel="noopener noreferrer" aria-label="Falar com ROL√ä no WhatsApp">
                            <img src="images/whatsapp.svg" alt="WhatsApp" width="20" height="20" loading="lazy" />
                        </a>
                    </div>
                </div>
            </nav>
        </div>

        <!-- Enhanced Hero Section -->
        <section class="app-hero-section" role="region" aria-labelledby="hero-title">
            <h1 class="app-hero-title" id="hero-title">REVISTA ROL√ä</h1>
            <p class="app-hero-description">
                Textos que refletem a cena noturna, com cr√≠ticas, poesia e provoca√ß√µes do ROL√ä
            </p>
            <div class="app-hero-cta">
                <a href="#editorial" class="app-btn-hero">Descubra nossos textos</a>
            </div>
        </section>

        <!-- Enhanced Stats Section -->
        <section class="app-section-header" role="region" aria-labelledby="stats-title">
            <h2 class="app-section-title" id="stats-title">REVISTA EM N√öMEROS</h2>
        </section>
        <div class="app-stats-grid" role="region" aria-label="Estat√≠sticas da revista">
            <div class="app-stat-item">
                <span class="app-stat-number" data-target="25" aria-label="25 artigos publicados">0</span>
                <span class="app-stat-label">Artigos publicados</span>
            </div>
            <div class="app-stat-item">
                <span class="app-stat-number" data-target="1.5" aria-label="1,5 milh√µes de leitores">0</span>
                <span class="app-stat-label">Milh√µes de leitores</span>
            </div>
            <div class="app-stat-item">
                <span class="app-stat-number" data-target="6" aria-label="6 se√ß√µes ativas">0</span>
                <span class="app-stat-label">Se√ß√µes ativas</span>
            </div>
            <div class="app-stat-item">
                <span class="app-stat-number" data-target="15" aria-label="15 entrevistas realizadas">0</span>
                <span class="app-stat-label">Entrevistas realizadas</span>
            </div>
        </div>

        <!-- Enhanced Editorial Section -->
        <section class="app-section-header" id="editorial" role="region" aria-labelledby="editorial-title">
            <h2 class="app-section-title" id="editorial-title">EDITORIAL</h2>
            <a href="#" class="app-see-all" aria-label="Ver todos os artigos editoriais">Ver todos</a>
        </section>

        <div class="app-recommendations" role="region" aria-label="Artigos editoriais">
            <div class="app-cards-scroll">
                <article class="app-recommendation-card">
                    <div class="app-card-image">
                        <div class="app-card-badge">Destaque</div>
                        <img src="images/editorial-madrugada.png" alt="Ilustra√ß√£o sobre a perda da madrugada nas cidades" loading="lazy" width="280" height="140" />
                    </div>
                    <div class="app-card-content">
                        <h3 class="app-card-title">As cidades j√° foram noturnas</h3>
                        <p class="app-card-description">Sua cidade perdeu a madrugada? Descubra quem resiste na cena noturna brasileira!</p>
                        <div class="app-card-info">
                            <div class="app-card-info-item">
                                <span role="img" aria-label="Editorial">üìù</span>
                                <span>Editorial</span>
                            </div>
                            <div class="app-card-info-item">
                                <span role="img" aria-label="Tempo de leitura">‚è±Ô∏è</span>
                                <span>5 min</span>
                            </div>
                        </div>
                        <div class="app-card-footer">
                            <div class="app-card-rating">
                                <div class="stars" aria-label="Avalia√ß√£o: 5 de 5 estrelas">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                                <span class="rating-text">5.0</span>
                            </div>
                            <a href="editorial/as-cidades-ja-foram-noturnas.html" class="app-card-link" rel="bookmark">Ler completo</a>
                        </div>
                    </div>
                </article>

                <article class="app-recommendation-card">
                    <div class="app-card-image">
                        <div class="app-card-badge">Popular</div>
                        <img src="images/editorial-dj-autor.png" alt="Arte de DJ como autor da pista" loading="lazy" width="280" height="140" />
                    </div>
                    <div class="app-card-content">
                        <h3 class="app-card-title">DJs s√£o novos autores</h3>
                        <p class="app-card-description">Quem escreve tua noite √© o DJ. J√° agradeceu hoje?</p>
                        <div class="app-card-info">
                            <div class="app-card-info-item">
                                <span role="img" aria-label="Editorial">üìù</span>
                                <span>Editorial</span>
                            </div>
                            <div class="app-card-info-item">
                                <span role="img" aria-label="Tempo de leitura">‚è±Ô∏è</span>
                                <span>4 min</span>
                            </div>
                        </div>
                        <div class="app-card-footer">
                            <div class="app-card-rating">
                                <div class="stars" aria-label="Avalia√ß√£o: 4,9 de 5 estrelas">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                                <span class="rating-text">4.9</span>
                            </div>
                            <a href="editorial/ja-agradeceu-o-dj-que-escreveu-a-historia-da-tua-noite.html" class="app-card-link" rel="bookmark">Ler completo</a>
                        </div>
                    </div>
                </article>

                <!-- Additional cards continue with enhanced accessibility... -->
                
            </div>
        </div>

        <!-- Enhanced Ad Container with lazy loading -->
        <div class="app-ad-container" role="complementary" aria-label="Publicidade">
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-2898945215492580"
                 data-ad-slot="1234567890"
                 data-ad-format="auto"
                 data-full-width-responsive="true"
                 loading="lazy"></ins>
        </div>

        <!-- Enhanced Newsletter Section -->
        <section class="app-newsletter-section" role="region" aria-labelledby="newsletter-title">
            <div class="app-newsletter-content">
                <h2 class="app-section-title" id="newsletter-title">N√£o perca o melhor da Revista ROL√ä</h2>
                <p>Assine a newsletter e receba semanalmente os melhores textos, entrevistas e achadinhos da cena cultural.</p>
                <form class="app-newsletter-form" id="newsletter-form" novalidate aria-live="polite">
                    <label for="newsletter-email" class="sr-only">Endere√ßo de e-mail</label>
                    <input type="email" 
                           id="newsletter-email"
                           name="email"
                           class="app-newsletter-input" 
                           placeholder="Seu melhor e-mail" 
                           required 
                           autocomplete="email"
                           aria-describedby="newsletter-disclaimer newsletter-status"
                           maxlength="254">
                    <button type="submit" class="app-btn-newsletter" aria-describedby="newsletter-status">
                        <span class="btn-text">Assinar</span>
                        <span class="btn-loading" aria-hidden="true">Enviando...</span>
                    </button>
                </form>
                <p class="newsletter-disclaimer" id="newsletter-disclaimer">
                    <small>Ao assinar, voc√™ concorda com nossa <a href="politica.html" rel="noopener">Pol√≠tica de Privacidade</a>.</small>
                </p>
                <div id="newsletter-status" class="sr-only" aria-live="polite" aria-atomic="true"></div>
            </div>
        </section>

        <!-- Enhanced Footer -->
        <footer class="app-footer" role="contentinfo">
            <div class="app-footer-links">
                ¬© 2025 ROL√ä ENTRETENIMENTO ¬∑
                <a href="politica.html" rel="noopener">Pol√≠tica de Privacidade</a> ¬∑
                <a href="termos-usuario.html" rel="noopener">Termos do Rolezeiro</a> ¬∑
                <a href="termos-organizador.html" rel="noopener">Termos do Organizador</a> ¬∑
                <a href="politica-spam.html" rel="noopener">Pol√≠tica Antispam</a>
            </div>
            <div class="app-social-icons">
                <a href="https://instagram.com/role.ent" target="_blank" rel="noopener noreferrer" aria-label="Seguir ROL√ä no Instagram">
                    <img src="images/instagram.svg" alt="" width="24" height="24" loading="lazy" />
                </a>
                <a href="https://tiktok.com/@role.ent" target="_blank" rel="noopener noreferrer" aria-label="Seguir ROL√ä no TikTok">
                    <img src="images/tiktok.svg" alt="" width="24" height="24" loading="lazy" />
                </a>
                <a href="https://wa.me/5551980704353" target="_blank" rel="noopener noreferrer" aria-label="Falar com ROL√ä no WhatsApp">
                    <img src="images/whatsapp.svg" alt="" width="24" height="24" loading="lazy" />
                </a>
            </div>
        </footer>

        <!-- Enhanced Bottom Navigation -->
        <nav class="app-bottom-nav" role="navigation" aria-label="Navega√ß√£o principal">
            <a href="index.html" class="app-nav-item" aria-label="P√°gina inicial" rel="home">
                <svg class="app-nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
                </svg>
                <span class="app-nav-label">Home</span>
            </a>
            <a href="vitrine-cultural.html" class="app-nav-item" aria-label="Vitrine cultural">
                <svg class="app-nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                </svg>
                <span class="app-nav-label">Buscar</span>
            </a>
            <a href="revista.html" class="app-nav-item active" aria-label="Revista ROL√ä" aria-current="page">
                <svg class="app-nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                </svg>
                <span class="app-nav-label">Revista</span>
            </a>
            <a href="descontos.html" class="app-nav-item" aria-label="Descontos">
                <svg class="app-nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path>
                </svg>
                <span class="app-nav-label">Descontos</span>
            </a>
            <a href="contato.html" class="app-nav-item" aria-label="Contato">
                <svg class="app-nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                </svg>
                <span class="app-nav-label">Contato</span>
            </a>
        </nav>
    </div>

    <!-- Optimized JavaScript with enhanced security and performance -->
    <script nonce="main-script-2024">
        (function() {
            'use strict';

            // Enhanced security: Content validation
            const validateContent = (content) => {
                if (typeof content !== 'string') return '';
                return content.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi, '');
            };

            // Enhanced security: Input sanitization with DOMPurify-like functionality
            const sanitizeInput = (str) => {
                if (!str) return '';
                const div = document.createElement('div');
                div.textContent = str;
                return div.innerHTML.substring(0, 500); // Limit length
            };

            // Enhanced security: Advanced rate limiting with exponential backoff
            const rateLimiter = {
                attempts: new Map(),
                isAllowed: function(key, maxAttempts = 3, windowMs = 300000, exponentialBackoff = true) {
                    const now = Date.now();
                    const attempts = this.attempts.get(key) || [];
                    const validAttempts = attempts.filter(time => now - time < windowMs);
                    
                    if (validAttempts.length >= maxAttempts) {
                        if (exponentialBackoff) {
                            const backoffMs = Math.min(windowMs * Math.pow(2, validAttempts.length - maxAttempts), 3600000);
                            return now - validAttempts[0] >= backoffMs;
                        }
                        return false;
                    }
                    
                    validAttempts.push(now);
                    this.attempts.set(key, validAttempts);
                    return true;
                }
            };

            // Enhanced performance: Optimized event delegation with passive listeners
            const delegateEvent = (parent, eventType, selector, handler, options = {}) => {
                const eventOptions = { passive: true, ...options };
                parent.addEventListener(eventType, function(e) {
                    const target = e.target.closest(selector);
                    if (target) {
                        handler.call(target, e);
                    }
                }, eventOptions);
            };

            // Enhanced performance: Intersection Observer with error handling
            const createOptimizedObserver = (callback, options = {}) => {
                const defaultOptions = {
                    threshold: 0.1,
                    rootMargin: '50px 0px',
                    ...options
                };

                try {
                    return new IntersectionObserver(callback, defaultOptions);
                } catch (error) {
                    console.warn('IntersectionObserver not supported:', error);
                    return null;
                }
            };

            // Enhanced DOM Ready with multiple fallbacks
            const onDOMReady = (callback) => {
                if (document.readyState === 'loading') {
                    document.addEventListener('DOMContentLoaded', callback, { once: true });
                } else {
                    // Use scheduler if available for better performance
                    if (window.scheduler && window.scheduler.postTask) {
                        window.scheduler.postTask(callback, { priority: 'user-blocking' });
                    } else if (window.requestIdleCallback) {
                        window.requestIdleCallback(callback, { timeout: 100 });
                    } else {
                        setTimeout(callback, 0);
                    }
                }
            };

            // Enhanced error reporting with privacy protection
            const reportError = (error, context = '') => {
                if (window.console && console.warn) {
                    console.warn(`ROL√ä Error [${context}]:`, error.message || error);
                }
                
                // Only log non-sensitive errors
                if (!error.message || !error.message.includes('network') && !error.message.includes('fetch')) {
                    // Could send to error tracking service here
                }
            };

            // Initialize critical functionality with error boundaries
            onDOMReady(() => {
                try {
                    initializeMenu();
                    initializeTheme();
                    initializeAnimations();
                    initializeNewsletter();
                    initializePerformanceMonitoring();
                } catch (error) {
                    reportError(error, 'Initialization');
                }
            });

            // Enhanced mobile menu with better accessibility
            function initializeMenu() {
                const menuToggle = document.querySelector('.menu-toggle');
                const menuClose = document.querySelector('.menu-close');
                const mobileMenuOverlay = document.getElementById('mobileMenuOverlay');

                if (!menuToggle || !mobileMenuOverlay) return;

                let isMenuOpen = false;
                const focusableElements = 'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])';

                const openMenu = () => {
                    if (isMenuOpen) return;
                    
                    isMenuOpen = true;
                    mobileMenuOverlay.classList.add('active');
                    mobileMenuOverlay.setAttribute('aria-hidden', 'false');
                    document.body.style.overflow = 'hidden';
                    menuToggle.setAttribute('aria-expanded', 'true');
                    
                    // Enhanced focus management
                    const firstFocusable = mobileMenuOverlay.querySelector(focusableElements);
                    if (firstFocusable) {
                        setTimeout(() => firstFocusable.focus(), 100);
                    }
                };

                const closeMenu = () => {
                    if (!isMenuOpen) return;
                    
                    isMenuOpen = false;
                    mobileMenuOverlay.classList.remove('active');
                    mobileMenuOverlay.setAttribute('aria-hidden', 'true');
                    document.body.style.overflow = '';
                    menuToggle.setAttribute('aria-expanded', 'false');
                    
                    // Return focus to trigger
                    setTimeout(() => menuToggle.focus(), 100);
                };

                // Enhanced event listeners with error handling
                try {
                    menuToggle.addEventListener('click', openMenu, { passive: true });
                    menuClose?.addEventListener('click', closeMenu, { passive: true });
                    
                    // Close on overlay click with better target detection
                    mobileMenuOverlay.addEventListener('click', (e) => {
                        if (e.target === mobileMenuOverlay || e.target.classList.contains('mobile-menu-overlay')) {
                            closeMenu();
                        }
                    }, { passive: true });

                    // Enhanced keyboard navigation
                    document.addEventListener('keydown', (e) => {
                        if (!isMenuOpen) return;
                        
                        if (e.key === 'Escape') {
                            e.preventDefault();
                            closeMenu();
                        } else if (e.key === 'Tab') {
                            // Trap focus within menu
                            const focusableElementsArray = Array.from(mobileMenuOverlay.querySelectorAll(focusableElements));
                            const firstElement = focusableElementsArray[0];
                            const lastElement = focusableElementsArray[focusableElementsArray.length - 1];

                            if (e.shiftKey && document.activeElement === firstElement) {
                                e.preventDefault();
                                lastElement.focus();
                            } else if (!e.shiftKey && document.activeElement === lastElement) {
                                e.preventDefault();
                                firstElement.focus();
                            }
                        }
                    }, { passive: false });

                } catch (error) {
                    reportError(error, 'Menu initialization');
                }
            }

            // Enhanced theme toggle with system preference detection
            function initializeTheme() {
                const themeToggle = document.querySelector('.theme-toggle-app');
                const root = document.documentElement;

                if (!themeToggle) return;

                try {
                    // Enhanced system preference detection
                    const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');
                    const systemPrefersDark = mediaQuery.matches;
                    const savedTheme = localStorage.getItem('theme');
                    
                    // Apply initial theme with better fallback
                    const initialTheme = savedTheme || (systemPrefersDark ? 'dark' : 'light');
                    root.setAttribute('data-theme', initialTheme);

                    // Listen for system theme changes
                    mediaQuery.addEventListener('change', (e) => {
                        if (!localStorage.getItem('theme')) {
                            const newTheme = e.matches ? 'dark' : 'light';
                            root.setAttribute('data-theme', newTheme);
                            showToast(`Tema ${newTheme === 'light' ? 'claro' : 'escuro'} detectado automaticamente`, 'info');
                        }
                    });

                    themeToggle.addEventListener('click', () => {
                        const currentTheme = root.getAttribute('data-theme');
                        const newTheme = currentTheme === 'light' ? 'dark' : 'light';
                        
                        try {
                            root.setAttribute('data-theme', newTheme);
                            localStorage.setItem('theme', newTheme);
                            showToast(`Tema ${newTheme === 'light' ? 'claro' : 'escuro'} ativado`, 'success');
                        } catch (storageError) {
                            reportError(storageError, 'Theme storage');
                            // Still apply theme even if storage fails
                            root.setAttribute('data-theme', newTheme);
                        }
                    }, { passive: true });

                } catch (error) {
                    reportError(error, 'Theme initialization');
                }
            }

            // Enhanced animations with performance optimization
            function initializeAnimations() {
                // Respect user's motion preferences
                if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                    return;
                }

                try {
                    // Enhanced stats animation with better performance
                    const statsObserver = createOptimizedObserver((entries) => {
                        entries.forEach(entry => {
                            if (entry.isIntersecting && !entry.target.dataset.animated) {
                                entry.target.dataset.animated = 'true';
                                animateNumber(entry.target);
                            }
                        });
                    }, { threshold: 0.5, rootMargin: '0px 0px -100px 0px' });

                    if (statsObserver) {
                        document.querySelectorAll('.app-stat-number').forEach(stat => {
                            statsObserver.observe(stat);
                        });
                    }

                    // Enhanced card animations with stagger
                    const cardObserver = createOptimizedObserver((entries) => {
                        entries.forEach((entry, index) => {
                            if (entry.isIntersecting) {
                                setTimeout(() => {
                                    entry.target.style.opacity = '1';
                                    entry.target.style.transform = 'translateY(0)';
                                }, index * 50); // Stagger animation
                            }
                        });
                    });

                    if (cardObserver) {
                        document.querySelectorAll('.app-recommendation-card, .app-stat-item').forEach((element, index) => {
                            element.style.opacity = '0';
                            element.style.transform = 'translateY(30px)';
                            element.style.transition = `all 0.6s cubic-bezier(0.4, 0, 0.2, 1) ${index * 0.05}s`;
                            cardObserver.observe(element);
                        });
                    }

                } catch (error) {
                    reportError(error, 'Animation initialization');
                }
            }

            // Enhanced number animation with better performance
            function animateNumber(element) {
                const target = parseFloat(element.getAttribute('data-target'));
                if (isNaN(target)) return;

                let current = 0;
                const isDecimal = target % 1 !== 0;
                const duration = 2000;
                const startTime = performance.now();

                const animate = (currentTime) => {
                    const elapsed = currentTime - startTime;
                    const progress = Math.min(elapsed / duration, 1);
                    
                    // Easing function for smoother animation
                    const easeOut = 1 - Math.pow(1 - progress, 3);
                    current = target * easeOut;
                    
                    if (isDecimal) {
                        element.textContent = current.toFixed(1);
                    } else {
                        element.textContent = Math.floor(current);
                    }

                    if (progress < 1) {
                        requestAnimationFrame(animate);
                    } else {
                        element.textContent = isDecimal ? target.toFixed(1) : target;
                    }
                };

                requestAnimationFrame(animate);
            }

            // Enhanced newsletter with comprehensive security
            function initializeNewsletter() {
                const form = document.getElementById('newsletter-form');
                if (!form) return;

                const emailInput = form.querySelector('input[type="email"]');
                const submitBtn = form.querySelector('button[type="submit"]');
                const btnText = submitBtn?.querySelector('.btn-text');
                const btnLoading = submitBtn?.querySelector('.btn-loading');
                const statusElement = document.getElementById('newsletter-status');

                if (!emailInput || !submitBtn) return;

                // Enhanced email validation with comprehensive checks
                const validateEmail = (email) => {
                    if (!email) return { valid: false, message: 'E-mail √© obrigat√≥rio' };
                    if (email.length > 254) return { valid: false, message: 'E-mail muito longo' };
                    
                    const emailRegex = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;
                    if (!emailRegex.test(email)) return { valid: false, message: 'Formato de e-mail inv√°lido' };
                    
                    // Additional security checks
                    const suspiciousPatterns = [
                        /[<>\"\']/,  // HTML/JS injection attempt
                        /script/i,   // Script tag attempt
                        /(\.\.\/|\.\.\\)/  // Path traversal attempt
                    ];
                    
                    for (const pattern of suspiciousPatterns) {
                        if (pattern.test(email)) {
                            return { valid: false, message: 'E-mail cont√©m caracteres inv√°lidos' };
                        }
                    }
                    
                    return { valid: true };
                };

                // Real-time validation with debouncing
                let validationTimeout;
                emailInput.addEventListener('input', () => {
                    clearTimeout(validationTimeout);
                    validationTimeout = setTimeout(() => {
                        const email = emailInput.value.trim();
                        const validation = validateEmail(email);
                        
                        emailInput.setCustomValidity(validation.valid ? '' : validation.message);
                        emailInput.setAttribute('aria-invalid', validation.valid ? 'false' : 'true');
                        
                        if (validation.message && email) {
                            showToast(validation.message, 'error');
                        }
                    }, 300);
                }, { passive: true });

                // Enhanced form submission with comprehensive security
                form.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    
                    const email = sanitizeInput(emailInput.value.trim());
                    const validation = validateEmail(email);
                    
                    if (!validation.valid) {
                        showStatus(validation.message, 'error');
                        emailInput.focus();
                        return;
                    }

                    // Enhanced rate limiting with fingerprinting
                    const clientFingerprint = await generateFingerprint();
                    if (!rateLimiter.isAllowed(clientFingerprint, 3, 300000)) {
                        showStatus('Muitas tentativas. Tente novamente em alguns minutos.', 'error');
                        return;
                    }
                    
                    setLoadingState(true);
                    
                    try {
                        const controller = new AbortController();
                        const timeoutId = setTimeout(() => controller.abort(), 8000);
                        
                        // Enhanced payload with additional security
                        const payload = {
                            email: email,
                            timestamp: Date.now(),
                            source: 'revista',
                            version: '2.0',
                            checksum: await generateChecksum(email)
                        };
                        
                        const response = await fetch('https://script.google.com/macros/s/AKfycbx0JqMhtw7RBl7XLqaq6uW4BuxsO6rL68njeMJG_OqJpo4NVbE--9cPyt_AYJLxhJ8/exec', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/x-www-form-urlencoded',
                                'X-Requested-With': 'XMLHttpRequest'
                            },
                            body: new URLSearchParams(payload),
                            signal: controller.signal,
                            credentials: 'omit' // Enhanced security
                        });
                        
                        clearTimeout(timeoutId);
                        
                        if (!response.ok) {
                            throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                        }
                        
                        const responseText = await response.text();
                        
                        // Validate response content
                        if (responseText && !responseText.includes('<script')) {
                            showStatus(`Sucesso! ${email} foi cadastrado na nossa newsletter.`, 'success');
                            form.reset();
                            emailInput.setAttribute('aria-invalid', 'false');
                        } else {
                            throw new Error('Invalid response format');
                        }
                        
                    } catch (error) {
                        let errorMessage = 'Erro ao cadastrar. Tente novamente mais tarde.';
                        
                        if (error.name === 'AbortError') {
                            errorMessage = 'Tempo esgotado. Verifique sua conex√£o.';
                        } else if (error.message.includes('NetworkError') || error.message.includes('Failed to fetch')) {
                            errorMessage = 'Problema de conex√£o. Verifique sua internet.';
                        }
                        
                        showStatus(errorMessage, 'error');
                        reportError(error, 'Newsletter submission');
                    } finally {
                        setLoadingState(false);
                    }
                });

                function setLoadingState(loading) {
                    if (submitBtn && btnText && btnLoading) {
                        submitBtn.disabled = loading;
                        btnText.style.display = loading ? 'none' : 'inline';
                        btnLoading.style.display = loading ? 'inline' : 'none';
                        submitBtn.setAttribute('aria-busy', loading.toString());
                    }
                }

                function showStatus(message, type) {
                    if (statusElement) {
                        statusElement.textContent = validateContent(message);
                        statusElement.className = `status-${type}`;
                        statusElement.setAttribute('aria-live', type === 'error' ? 'assertive' : 'polite');
                    }
                    showToast(message, type);
                }
            }

            // Enhanced client fingerprinting for security
            async function generateFingerprint() {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                ctx.textBaseline = 'top';
                ctx.font = '14px Arial';
                ctx.fillText('ROL√ä Security Check', 2, 2);
                
                const fingerprint = [
                    navigator.userAgent || '',
                    navigator.language || '',
                    screen.width + 'x' + screen.height,
                    new Date().getTimezoneOffset(),
                    canvas.toDataURL()
                ].join('|');
                
                return hashCode(fingerprint);
            }

            // Enhanced checksum generation
            async function generateChecksum(data) {
                const encoder = new TextEncoder();
                const dataBuffer = encoder.encode(data + 'ROLE_SALT_2024');
                
                if (crypto.subtle) {
                    try {
                        const hashBuffer = await crypto.subtle.digest('SHA-256', dataBuffer);
                        const hashArray = Array.from(new Uint8Array(hashBuffer));
                        return hashArray.map(b => b.toString(16).padStart(2, '0')).join('').slice(0, 16);
                    } catch (error) {
                        reportError(error, 'Checksum generation');
                    }
                }
                
                // Fallback to simple hash
                return hashCode(data).toString(16);
            }

            // Enhanced hash function
            function hashCode(str) {
                let hash = 0;
                if (str.length === 0) return hash;
                for (let i = 0; i < str.length; i++) {
                    const char = str.charCodeAt(i);
                    hash = ((hash << 5) - hash) + char;
                    hash = hash & hash; // Convert to 32bit integer
                }
                return Math.abs(hash);
            }

            // Enhanced toast system with better accessibility
            function showToast(message, type = 'info') {
                // Remove existing toasts
                document.querySelectorAll('.toast').forEach(toast => toast.remove());

                const toast = document.createElement('div');
                toast.className = `toast ${type}`;
                toast.textContent = validateContent(message);
                toast.setAttribute('role', type === 'error' ? 'alert' : 'status');
                toast.setAttribute('aria-live', type === 'error' ? 'assertive' : 'polite');
                toast.setAttribute('aria-atomic', 'true');
                
                // Enhanced positioning for mobile
                toast.style.cssText = `
                    position: fixed;
                    bottom: ${window.innerWidth <= 768 ? '120px' : '40px'};
                    left: 50%;
                    transform: translateX(-50%);
                    background: ${type === 'success' ? '#10B981' : type === 'error' ? '#EF4444' : '#8B5CF6'};
                    color: white;
                    padding: 12px 24px;
                    border-radius: 25px;
                    font-weight: 600;
                    font-size: 14px;
                    z-index: 10000;
                    opacity: 0;
                    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
                    max-width: 90vw;
                    text-align: center;
                `;
                
                document.body.appendChild(toast);
                
                // Show with animation
                requestAnimationFrame(() => {
                    toast.style.opacity = '1';
                    toast.style.transform = 'translateX(-50%) translateY(-10px)';
                });
                
                // Auto hide with cleanup
                setTimeout(() => {
                    toast.style.opacity = '0';
                    toast.style.transform = 'translateX(-50%) translateY(0)';
                    setTimeout(() => {
                        if (toast.parentNode) {
                            toast.remove();
                        }
                    }, 300);
                }, 4000);
            }

            // Enhanced performance monitoring
            function initializePerformanceMonitoring() {
                if (!('PerformanceObserver' in window)) return;

                try {
                    // Monitor Core Web Vitals
                    const observer = new PerformanceObserver((list) => {
                        list.getEntries().forEach((entry) => {
                            switch (entry.entryType) {
                                case 'largest-contentful-paint':
                                    if (entry.startTime < 2500) {
                                        console.log('‚úÖ Good LCP:', entry.startTime);
                                    } else {
                                        console.warn('‚ö†Ô∏è Poor LCP:', entry.startTime);
                                    }
                                    break;
                                case 'first-input':
                                    if (entry.processingStart - entry.startTime < 100) {
                                        console.log('‚úÖ Good FID:', entry.processingStart - entry.startTime);
                                    } else {
                                        console.warn('‚ö†Ô∏è Poor FID:', entry.processingStart - entry.startTime);
                                    }
                                    break;
                                case 'layout-shift':
                                    if (entry.value < 0.1) {
                                        console.log('‚úÖ Good CLS:', entry.value);
                                    } else {
                                        console.warn('‚ö†Ô∏è Poor CLS:', entry.value);
                                    }
                                    break;
                            }
                        });
                    });

                    observer.observe({ entryTypes: ['largest-contentful-paint', 'first-input', 'layout-shift'] });

                    // Memory usage monitoring
                    if (performance.memory) {
                        setInterval(() => {
                            const memoryUsage = performance.memory.usedJSHeapSize / 1048576; // MB
                            if (memoryUsage > 50) {
                                console.warn('‚ö†Ô∏è High memory usage:', memoryUsage.toFixed(2), 'MB');
                            }
                        }, 30000);
                    }

                } catch (error) {
                    reportError(error, 'Performance monitoring');
                }
            }

            // Enhanced scroll behavior for hero CTA
            const heroButton = document.querySelector('.app-btn-hero');
            if (heroButton) {
                heroButton.addEventListener('click', (e) => {
                    e.preventDefault();
                    const target = document.getElementById('editorial');
                    if (target) {
                        target.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                        
                        // Focus management for accessibility
                        setTimeout(() => {
                            const firstFocusable = target.querySelector('a, button, [tabindex]:not([tabindex="-1"])');
                            if (firstFocusable) {
                                firstFocusable.focus();
                            }
                        }, 1000);
                    }
                }, { passive: false });
            }

            // Enhanced touch/swipe support for cards
            document.querySelectorAll('.app-cards-scroll').forEach(scrollContainer => {
                let startX = 0;
                let scrollLeft = 0;
                let isDown = false;

                scrollContainer.addEventListener('touchstart', (e) => {
                    startX = e.touches[0].clientX;
                    scrollLeft = scrollContainer.scrollLeft;
                }, { passive: true });

                scrollContainer.addEventListener('touchmove', (e) => {
                    if (!startX) return;
                    const x = e.touches[0].clientX;
                    const walk = (startX - x) * 2;
                    scrollContainer.scrollLeft = scrollLeft + walk;
                }, { passive: true });

                scrollContainer.addEventListener('touchend', () => {
                    startX = 0;
                }, { passive: true });
            });

            // Initialize Google Ads with error handling
            window.addEventListener('load', () => {
                if (window.adsbygoogle) {
                    try {
                        (window.adsbygoogle = window.adsbygoogle || []).push({});
                    } catch (error) {
                        reportError(error, 'AdSense initialization');
                    }
                }
            }, { once: true });

            // Enhanced navigation state management
            const updateNavigation = () => {
                const navItems = document.querySelectorAll('.app-nav-item, .mobile-menu-link, .desktop-menu a');
                const currentPage = window.location.pathname.split('/').pop() || 'index.html';
                
                navItems.forEach(item => {
                    const href = item.getAttribute('href');
                    if (href === currentPage || (currentPage === 'revista.html' && href === 'revista.html')) {
                        item.classList.add('active');
                        item.setAttribute('aria-current', 'page');
                    } else {
                        item.classList.remove('active');
                        item.removeAttribute('aria-current');
                    }
                });
            };

            updateNavigation();

            // Enhanced lazy loading with error handling
            if ('IntersectionObserver' in window) {
                const lazyImageObserver = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const img = entry.target;
                            if (img.dataset.src) {
                                img.src = img.dataset.src;
                                img.removeAttribute('data-src');
                                lazyImageObserver.unobserve(img);
                            }
                        }
                    });
                });

                document.querySelectorAll('img[data-src]').forEach(img => {
                    lazyImageObserver.observe(img);
                });
            }

            // Enhanced error boundary for global errors
            window.addEventListener('error', (e) => {
                reportError(e.error, 'Global error');
            });

            window.addEventListener('unhandledrejection', (e) => {
                reportError(e.reason, 'Unhandled promise rejection');
            });

        })();
    </script>

    <!-- Enhanced font loading with fallback -->
    <script>
        window.addEventListener('load', function() {
            const fontLink = document.createElement('link');
            fontLink.href = 'https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap';
            fontLink.rel = 'stylesheet';
            fontLink.media = 'print';
            fontLink.onload = function() { 
                this.media = 'all'; 
                document.documentElement.classList.add('fonts-loaded');
            };
            fontLink.onerror = function() {
                console.warn('Google Fonts failed to load, using fallback');
                document.documentElement.classList.add('fonts-fallback');
            };
            document.head.appendChild(fontLink);
        }, { once: true });
    </script>

    <!-- Enhanced Service Worker with update notifications -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js')
                    .then(function(registration) {
                        console.log('‚úÖ Service Worker registered:', registration.scope);
                        
                        // Listen for updates
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    // Show update notification
                                    const updateToast = document.createElement('div');
                                    updateToast.innerHTML = `
                                        <div style="position: fixed; bottom: 20px; left: 20px; right: 20px; background: #8B5CF6; color: white; padding: 16px; border-radius: 12px; z-index: 10001; text-align: center;">
                                            <p style="margin: 0 0 12px 0; font-weight: 600;">Nova vers√£o dispon√≠vel!</p>
                                            <button onclick="window.location.reload()" style="background: white; color: #8B5CF6; border: none; padding: 8px 16px; border-radius: 8px; font-weight: 600; cursor: pointer;">
                                                Atualizar agora
                                            </button>
                                            <button onclick="this.parentElement.parentElement.remove()" style="background: transparent; color: white; border: 1px solid white; padding: 8px 16px; border-radius: 8px; font-weight: 600; cursor: pointer; margin-left: 8px;">
                                                Depois
                                            </button>
                                        </div>
                                    `;
                                    document.body.appendChild(updateToast);
                                }
                            });
                        });
                    })
                    .catch(function(registrationError) {
                        console.warn('Service Worker registration failed:', registrationError);
                    });
            }, { once: true });
        }
    </script>

    <!-- Enhanced Web App Manifest for PWA -->
    <script>
        // Add to home screen prompt handling
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // Show install button after user interaction
            setTimeout(() => {
                if (deferredPrompt && !window.matchMedia('(display-mode: standalone)').matches) {
                    const installBanner = document.createElement('div');
                    installBanner.innerHTML = `
                        <div style="position: fixed; bottom: 20px; left: 20px; right: 20px; background: linear-gradient(135deg, #8B5CF6, #EC4899); color: white; padding: 16px; border-radius: 12px; z-index: 10002; text-align: center; box-shadow: 0 8px 24px rgba(0,0,0,0.3);">
                            <p style="margin: 0 0 12px 0; font-weight: 600;">üì± Instalar ROL√ä como app</p>
                            <p style="margin: 0 0 12px 0; font-size: 14px; opacity: 0.9;">Acesso r√°pido direto da tela inicial</p>
                            <button id="install-app" style="background: white; color: #8B5CF6; border: none; padding: 10px 20px; border-radius: 8px; font-weight: 600; cursor: pointer; margin-right: 8px;">
                                Instalar
                            </button>
                            <button onclick="this.parentElement.parentElement.remove()" style="background: transparent; color: white; border: 1px solid rgba(255,255,255,0.5); padding: 10px 20px; border-radius: 8px; font-weight: 600; cursor: pointer;">
                                Agora n√£o
                            </button>
                        </div>
                    `;
                    document.body.appendChild(installBanner);
                    
                    document.getElementById('install-app').addEventListener('click', async () => {
                        if (deferredPrompt) {
                            deferredPrompt.prompt();
                            const { outcome } = await deferredPrompt.userChoice;
                            console.log('Install prompt outcome:', outcome);
                            deferredPrompt = null;
                            installBanner.remove();
                        }
                    });
                }
            }, 5000);
        });

        // Track app installation
        window.addEventListener('appinstalled', (evt) => {
            console.log('‚úÖ ROL√ä app installed successfully');
            // Could send analytics event here
        });
    </script>

    <!-- Critical Resource Hints for next navigation -->
    <script>
        // Preload likely next pages
        const preloadPages = ['vitrine-cultural.html', 'descontos.html'];
        preloadPages.forEach(page => {
            const link = document.createElement('link');
            link.rel = 'prefetch';
            link.href = page;
            document.head.appendChild(link);
        });

        // Preload critical images on idle
        if ('requestIdleCallback' in window) {
            requestIdleCallback(() => {
                const criticalImages = [
                    'images/editorial-teatros-vazios.png',
                    'images/editorial-look-fala.png',
                    'images/posfacio-arte-nao-e-favor.png'
                ];
                
                criticalImages.forEach(src => {
                    const img = new Image();
                    img.src = src;
                });
            });
        }
    </script>

    <!-- Enhanced Analytics and Performance Tracking -->
    <script>
        // Simple analytics without external dependencies
        (function() {
            const analytics = {
                track: function(event, data = {}) {
                    // Privacy-first analytics
                    const payload = {
                        event: event,
                        timestamp: Date.now(),
                        page: location.pathname,
                        ...data
                    };
                    
                    // Could send to analytics service here
                    console.log('üìä Analytics:', payload);
                },
                
                trackPageView: function() {
                    this.track('page_view', {
                        title: document.title,
                        referrer: document.referrer ? new URL(document.referrer).hostname : 'direct'
                    });
                },
                
                trackPerformance: function() {
                    window.addEventListener('load', () => {
                        setTimeout(() => {
                            const perfData = performance.getEntriesByType('navigation')[0];
                            if (perfData) {
                                this.track('performance', {
                                    load_time: Math.round(perfData.loadEventEnd - perfData.fetchStart),
                                    dom_content_loaded: Math.round(perfData.domContentLoadedEventEnd - perfData.fetchStart),
                                    first_byte: Math.round(perfData.responseStart - perfData.fetchStart)
                                });
                            }
                        }, 1000);
                    }, { once: true });
                }
            };
            
            analytics.trackPageView();
            analytics.trackPerformance();
            
            // Track interactions
            ['click', 'submit'].forEach(eventType => {
                document.addEventListener(eventType, (e) => {
                    if (e.target.matches('.app-card-link, .app-btn-hero, .app-btn-newsletter')) {
                        analytics.track('interaction', {
                            type: eventType,
                            element: e.target.textContent.trim() || e.target.getAttribute('aria-label') || 'unknown'
                        });
                    }
                }, { passive: true });
            });
            
            window.roleAnalytics = analytics;
        })();
    </script>

    <!-- Enhanced Security Monitoring -->
    <script>
        (function() {
            // Content Security Policy violation monitoring
            document.addEventListener('securitypolicyviolation', (e) => {
                console.warn('üîí CSP Violation:', {
                    directive: e.violatedDirective,
                    blocked: e.blockedURI,
                    source: e.sourceFile,
                    line: e.lineNumber
                });
            });

            // Monitor for suspicious activity
            let suspiciousActivity = 0;
            const suspiciousEvents = ['contextmenu', 'selectstart', 'dragstart'];
            
            suspiciousEvents.forEach(event => {
                document.addEventListener(event, () => {
                    suspiciousActivity++;
                    if (suspiciousActivity > 10) {
                        console.warn('üîí Suspicious activity detected');
                        // Could implement additional security measures here
                    }
                }, { passive: true });
            });

            // Detect dev tools (simple check)
            let devtools = { open: false };
            setInterval(() => {
                if (window.outerHeight - window.innerHeight > 200 || window.outerWidth - window.innerWidth > 200) {
                    if (!devtools.open) {
                        devtools.open = true;
                        console.log('üîß Developer tools detected - Bem-vindo, dev! üëã');
                    }
                } else {
                    devtools.open = false;
                }
            }, 1000);
        })();
    </script>

</body>
</html>
